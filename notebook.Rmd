# TP1 - Document clustering avec le modèle JOSE sur BBC-News dataset

Ce TP est réalisé dans le cadre d'évaluation du module mixture-models et co-clustering du master 2 MLDS - Machine Learning for Data Science.

Equipe :

-   Abdesselam BENAMEUR

-   Hakim IGUENI

# TODOs

```{r}
# TODO: TREAT ALL THE TODOs IN THIS FILE
```

# Install Packages

```{r}
install.packages("NbClust")
# install.packages("factoextra")
install.packages("skmeans")
install.packages("movMF")
install.packages("R.matlab")
install.packages("aricode")
```

# Import Packages

```{r}
library(NbClust)
# library(factoextra)
library(skmeans)
library(movMF)
library(R.matlab)
library(aricode)
```

# Load Data

```{r}
# Le lien pour télécharger les deux formats de données ainsi que les labels.
url <- "https://cifre.s3.eu-north-1.amazonaws.com/bbc_dataset.mat"
# Définir le nom du fichier de destination.
destination_file <- "bbc_dataset.mat"
# Télécharger le fichier.
# download.file(url, destfile = destination_file, method = "auto")
# TODO: change url to destination_file
bbc_dataset <- readMat(url)
bbc_jose <- bbc_dataset$jose
bbc_doc_term <- bbc_dataset$doc.term
bbc_labels <- as.vector(bbc_dataset$labels)
```

```{r}
dim(bbc_jose)
```

```{r}
dim(bbc_doc_term)
```

1.  **Quelle est la dimension de chaque dataset (nombre documents, nombre de mots/taille de la dimension) ?**

-   Le 1er dataset (la matrice document-terme, la variable bbc_doc_term)

    -   nombre documents: 2225

    -   nombre de mots: 2000

-   Le 2eme dataset (la matrice des embeddings des documents, la variable bbc_jose)

    -   nombre documents: 2225

    -   taille de la dimension: 100

2.  **Exécuter tous les algorithmes de clustering avec le vrai nombre de classes qui est 5.**

3.  **Afficher les matrices de confusion obtenues à chaque application d'un algorithme de clustering.**

4.  **Pour mesurer la qualité du clustering obtenu, on s\'appuiera sur les mesures externes : NMI et ARI.**

5.  **Commenter les résultats obtenus.**

6.  ~[***Questions\ optionnelles\ :***]{.underline}~

    ~[***a.\ Toute\ utilisation\ d\'un\ algorithme\ de\ clustering\ supplémentaire\ sera\ apprécié.***]{.underline}~

    ~[***b.\ Une\ analyse\ sur\ le\ nombre\ de\ clusters\ peut\ être\ envisagée\ à\ partir\ de\ vos\ connaissances.***]{.underline}~

# Clustering of the first Dataset (bbc_doc_term)

## K-means

```{r}
# we use nbclust, and k = 5
set.seed(123)
res.kmeans <- NbClust(bbc_jose, distance = "euclidean", min.nc = 4, max.nc = 6, method = "kmeans")
# res.kmeans <- kmeans(bbc_doc_term, 5, nstart = 25)
# TODO: we are asked to use NbClust, not the function kmeans !!!

# # we use fviz_cluster to visualize the clusters without points labels
# library(factoextra)
# fviz_cluster(res.kmeans, data = bbc_jose, ellipse.type = "norm", 
#              palette = "jco", ggtheme = theme_minimal(),
#              main = "K-means clustering of documents")
```

```{r}
# confusion matrix
clusters.kmeans <- res.kmeans$Best.partition
table(clusters.kmeans, bbc_labels)

# NMI
nmi.kmeans <- NMI(clusters.kmeans, bbc_labels)
paste("NMI:", nmi.kmeans)

# ARI
ari.kmeans <- ARI(clusters.kmeans, bbc_labels)
paste("ARI:", ari.kmeans)
```

## Spherical K-means

```{r}
# we use skmeans, and k = 5
set.seed(123)
res.skmeans <- skmeans(bbc_doc_term, 5)

# confusion matrix
clusters.skmeans <- res.skmeans$cluster
table(clusters.skmeans, bbc_labels)

# NMI
nmi.skmeans <- NMI(clusters.skmeans, bbc_labels)
paste("NMI:", nmi.skmeans)

# ARI
ari.skmeans <- ARI(clusters.skmeans, bbc_labels)
paste("ARI:", ari.skmeans)
```

## von-Mises Fisher Mixture Model

```{r}
# we use movMF, and k = 5
set.seed(123)
res.movMF <- movMF(bbc_doc_term, 5, kappa=list(common = TRUE))
# TODO: explore the other params of movMF
clusters.movMF <- apply(res.movMF$P,1,which.max)

# confusion matrix
table(clusters.movMF, bbc_labels)

# NMI
nmi.movMF <- NMI(clusters.movMF, bbc_labels)
paste("NMI:", nmi.movMF)

# ARI
ari.movMF <- ARI(clusters.movMF, bbc_labels)
paste("ARI:", ari.movMF)
```

## Hierarchical Clustering

```{r}
# we use hclust, and k = 5
res.hclust <- hclust(dist(bbc_doc_term), method = "ward.D2")

# confusion matrix
print("Confusion matrix")
clusters.hclust <- cutree(res.hclust, 5)
table(clusters.hclust, bbc_labels)

# NMI
nmi.hclust <- NMI(clusters.hclust, bbc_labels)
paste("NMI:", nmi.hclust)

# ARI

ari.hclust <- ARI(clusters.hclust, bbc_labels)
paste("ARI:", ari.hclust)
```

# Clustering of second Dataset (bbc_jose)

```{r}
# TODO: explore different values of the parameters of skmeans and the other clustering algorithms
# TODO: try different values of k and try to prove that k=5 is the best one
```

## K-means

```{r}
# we use nbclust, and k = 5
set.seed(123)
res.kmeans <- NbClust(bbc_jose, distance = "euclidean", min.nc = 4, max.nc = 6, method = "kmeans")
#res.kmeans <- kmeans(bbc_jose, 5, nstart = 25)
# TODO: we are asked to use NbClust, not the function kmeans !!!

# # we use fviz_cluster to visualize the clusters without points labels
# library(factoextra)
# fviz_cluster(res.kmeans, data = bbc_jose, ellipse.type = "norm", 
#              palette = "jco", ggtheme = theme_minimal(),
#              main = "K-means clustering of documents")


```

```{r}
# confusion matrix
clusters.kmeans <- res.kmeans$Best.partition
table(clusters.kmeans, bbc_labels)

# NMI
nmi.kmeans <- NMI(clusters.kmeans, bbc_labels)
paste("NMI:", nmi.kmeans)

# ARI
ari.kmeans <- ARI(clusters.kmeans, bbc_labels)
paste("ARI:", ari.kmeans)
```

En utilisant le package Nbclust avec plusieurs valeurs de k = {4, 5, 6} pour le nombre de clusters, on conclut que le meilleur clustering est celui avec K=5.

## Spherical K-means

```{r}
# we use skmeans, and k = 5
set.seed(123)
res.skmeans <- skmeans(bbc_jose, 5)

# confusion matrix
clusters.skmeans <- res.skmeans$cluster
table(clusters.skmeans, bbc_labels)

# NMI
nmi.skmeans <- NMI(clusters.skmeans, bbc_labels)
paste("NMI:", nmi.skmeans)

# ARI
ari.skmeans <- ARI(clusters.skmeans, bbc_labels)
paste("ARI:", ari.skmeans)
```

## von-Mises Fisher Mixture Model

```{r}
# we use movMF, and k = 5
set.seed(123)
res.movMF <- movMF(bbc_jose, 5, kappa=list(common = TRUE))
# TODO: explore the other params of movMF
clusters.movMF <- apply(res.movMF$P,1,which.max)

# confusion matrix
table(clusters.movMF, bbc_labels)

# NMI
nmi.movMF <- NMI(clusters.movMF, bbc_labels)
paste("NMI:", nmi.movMF)

# ARI
ari.movMF <- ARI(clusters.movMF, bbc_labels)
paste("ARI:", ari.movMF)
```

## Hierarchical Clustering

```{r}
# we use hclust, and k = 5
res.hclust <- hclust(dist(bbc_jose), method = "ward.D2")

# confusion matrix
print("Confusion matrix")
clusters.hclust <- cutree(res.hclust, 5)
table(clusters.hclust, bbc_labels)

# NMI
nmi.hclust <- NMI(clusters.hclust, bbc_labels)
paste("NMI:", nmi.hclust)

# ARI

ari.hclust <- ARI(clusters.hclust, bbc_labels)
paste("ARI:", ari.hclust)
```

```{r}

```

```{r}
```
